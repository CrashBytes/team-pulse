generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(uuid())
  email     String   @unique
  name      String
  role      String   @default("user")
  jiraId    String?
  githubId  String?
  slackId   String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  metrics UserMetrics[]
  @@map("users")
}

model UserMetrics {
  id           String   @id @default(uuid())
  userId       String
  date         DateTime @default(now())
  source       String   // 'jira', 'github', 'sonarqube', 'snyk', 'slack'
  metricType   String
  value        Float
  metadata     Json?
  
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  @@map("user_metrics")
  @@index([userId, source, date])
}

model TeamMetrics {
  id           String   @id @default(uuid())
  teamName     String
  date         DateTime @default(now())
  source       String
  metricType   String
  value        Float
  metadata     Json?
  
  @@map("team_metrics")
  @@index([teamName, source, date])
}

model Configuration {
  id    String @id @default(uuid())
  key   String @unique
  value String
  
  @@map("configurations")
}